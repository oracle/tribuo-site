---
title: "Configuration"
og-title: "Configuration Tutorial"
learn_nav: true
parent: Tutorials
nav_order: 307
is_notebook: true
notebook_url: https://github.com/oracle/tribuo/blob/main/tutorials/configuration-tribuo-v4.ipynb
comment: ## DO NOT EDIT THIS FILE. IT IS COPIED FROM THE TRIBUO DOC. EDIT IT THERE. ##
---
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Configuration-Tutorial">Configuration Tutorial<a class="anchor-link" href="#Configuration-Tutorial">&#182;</a></h1><p>This tutorial will show how to use Tribuo's configuration and provenance systems to build models on MNIST (because we wouldn't be doing ML without an MNIST demo).
We'll focus on logistic regression, show how many different trainers can be stored in the same configuration, and how the provenance system allows the configuration for a specific run to be regenerated.
We'll also briefly look at Tribuo's feature transformation system and see how that integrates into configuration and provenance.</p>
<h2 id="Setup">Setup<a class="anchor-link" href="#Setup">&#182;</a></h2><p>You'll need to get a copy of the MNIST dataset in the original IDX format.</p>
<p>First the training data:</p>
<p><code>wget http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz</code></p>
<p>Then the test data:</p>
<p><code>wget http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz</code></p>
<p>Tribuo's IDX loader natively reads gzipped files so you don't need to unzip them.</p>
<p>It's Java, so first we load in the necessary Tribuo jars. Here we're using the classification experiments jar, along with the json interop jar to read and write the provenance information.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="o">%</span><span class="n">jars</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">tribuo</span><span class="o">-</span><span class="n">classification</span><span class="o">-</span><span class="n">experiments</span><span class="o">-</span><span class="mf">4.3.0</span><span class="o">-</span><span class="n">jar</span><span class="o">-</span><span class="n">with</span><span class="o">-</span><span class="n">dependencies</span><span class="p">.</span><span class="na">jar</span><span class="w"></span>
<span class="o">%</span><span class="n">jars</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">tribuo</span><span class="o">-</span><span class="n">json</span><span class="o">-</span><span class="mf">4.3.0</span><span class="o">-</span><span class="n">jar</span><span class="o">-</span><span class="n">with</span><span class="o">-</span><span class="n">dependencies</span><span class="p">.</span><span class="na">jar</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now lets import the packages we need. We'll use a few file manipulation things from Java, and then Tribuo's core packages, the transformation packages, the classification package, classification evaluation package, and then a few things that relate to the provenance system.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.nio.file.Files</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.nio.file.Paths</span><span class="p">;</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.tribuo.*</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.tribuo.util.Util</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.tribuo.transform.*</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.tribuo.transform.transformations.LinearScalingTransformation</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.tribuo.classification.*</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.tribuo.classification.evaluation.*</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.oracle.labs.mlrg.olcut.config.Configurable</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.oracle.labs.mlrg.olcut.config.ConfigurationManager</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.oracle.labs.mlrg.olcut.config.DescribeConfigurable</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.oracle.labs.mlrg.olcut.provenance.*</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.oracle.labs.mlrg.olcut.provenance.primitives.*</span><span class="p">;</span><span class="w"></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.oracle.labs.mlrg.olcut.config.json.JsonConfigFactory</span><span class="p">;</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By default OLCUT's <code>ConfigurationManager</code> only understands XML files, the snippet below adds JSON support to all <code>ConfigurationManager</code>s in the running JVM. It can be added dynamically on the command line by supplying <code>--config-file-format &lt;fully-qualified-class-name&gt;</code> where the class name is for example <code>com.oracle.labs.mlrg.olcut.config.json.JsonConfigFactory</code>, if you're using OLCUT's CLI options processing.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="n">ConfigurationManager</span><span class="p">.</span><span class="na">addFileFormatFactory</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">JsonConfigFactory</span><span class="p">())</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>OLCUT supports XML, JSON, <a href="https://github.com/edn-format/edn">edn</a>, and <a href="https://developers.google.com/protocol-buffers">protobuf</a> format configuration files. It also supports serialization for <code>Provenance</code> objects in XML, JSON, and protobuf formats.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-does-configuration-work?">How does configuration work?<a class="anchor-link" href="#How-does-configuration-work?">&#182;</a></h2><p>Tribuo uses a configuration system originally built in Sun Labs, open sourced in the <a href="https://github.com/oracle/olcut">OLCUT</a> library. Classes which can be configured must implement the <code>Configurable</code> interface, and optionally implement a <code>public void postConfig()</code> method, which can be used to check invariants after a class has beeen configured but before it's visible. Configurable classes can mark which of their fields are available for configuration using the <code>@Config</code> annotation, which accepts three arguments: <code>boolean mandatory</code> if the configuration system should error out when the field is not configured, <code>String description</code> a description of the field used as a comment and in the <code>DescribeConfigurable</code> system seen below, and <code>boolean redact</code> which controls if this field value should be saved into configuration files or written into provenance objects.</p>
<p>As configuration is part of the class file rather than the public documented API (because it operates on private fields), OLCUT ships with a CLI utility for inspecting a configurable class and generating an example configuration in any supported configuration format. To use this utility from the command line you can run:</p>

<pre><code>$ java -cp &lt;path-to-jars-including-olcut-core&gt; com.oracle.labs.mlrg.olcut.config.DescribeConfigurable -n &lt;class-name&gt; -o -e xml</code></pre>
<p>where the <code>-n</code> argument denotes what class to describe, <code>-o</code> denotes that an example configuration should be generated, and <code>-e</code> gives the file format to emit the example configuration in.</p>
<p>You can also use the REPL to inspect a configurable class, like so:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;org.tribuo.classification.sgd.linear.LinearSGDTrainer&quot;</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">clazz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Configurable</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="n">className</span><span class="p">);</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DescribeConfigurable</span><span class="p">.</span><span class="na">generateFieldInfo</span><span class="p">(</span><span class="n">clazz</span><span class="p">);</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DescribeConfigurable</span><span class="p">.</span><span class="na">generateDescription</span><span class="p">(</span><span class="n">map</span><span class="p">);</span><span class="w"></span>

<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Class: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">clazz</span><span class="p">.</span><span class="na">getCanonicalName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">DescribeConfigurable</span><span class="p">.</span><span class="na">formatDescription</span><span class="p">(</span><span class="n">output</span><span class="p">));</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Class: org.tribuo.classification.sgd.linear.LinearSGDTrainer

Field Name      Type                                         Mandatory Redact Default                                                       Description
epochs          int                                          false     false  5                                                             The number of gradient descent epochs.
loggingInterval int                                          false     false  -1                                                            Log values after this many updates.
minibatchSize   int                                          false     false  1                                                             Minibatch size in SGD.
objective       org.tribuo.classification.sgd.LabelObjective false     false  LogMulticlass                                                 The classification objective function to use.
optimiser       org.tribuo.math.StochasticGradientOptimiser  false     false  AdaGrad(initialLearningRate=1.0,epsilon=0.1,initialValue=0.0) The gradient optimiser to use.
seed            long                                         false     false  12345                                                         Seed for the RNG used to shuffle elements.
shuffle         boolean                                      false     false  true                                                          Shuffle the data before each epoch. Only turn off for debugging.

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And also to print out an example config file:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="n">ByteArrayOutputStream</span><span class="w"> </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ByteArrayOutputStream</span><span class="p">();</span><span class="w"></span>
<span class="n">DescribeConfigurable</span><span class="p">.</span><span class="na">writeExampleConfig</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span><span class="s">&quot;json&quot;</span><span class="p">,</span><span class="n">clazz</span><span class="p">,</span><span class="n">map</span><span class="p">);</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">writer</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="s">&quot;UTF-8&quot;</span><span class="p">));</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>{
  &#34;config&#34; : {
    &#34;components&#34; : [ {
      &#34;name&#34; : &#34;example&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.sgd.linear.LinearSGDTrainer&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;seed&#34; : &#34;0&#34;,
        &#34;minibatchSize&#34; : &#34;0&#34;,
        &#34;shuffle&#34; : &#34;false&#34;,
        &#34;epochs&#34; : &#34;0&#34;,
        &#34;optimiser&#34; : &#34;StochasticGradientOptimiser-instance&#34;,
        &#34;loggingInterval&#34; : &#34;0&#34;,
        &#34;objective&#34; : &#34;LabelObjective-instance&#34;
      }
    } ]
  }
}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-a-configuration-file">Using a configuration file<a class="anchor-link" href="#Using-a-configuration-file">&#182;</a></h2><p>We're going to read in an example configuration file, in JSON format. This configuration knows about a bunch of different trainers, and also the training and testing MNIST data sources. In the tutorials directory we supply both the JSON and XML versions of this file, and the remainder of this tutorial is completely agnostic to which one is used.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">configPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Paths</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;configuration&quot;</span><span class="p">,</span><span class="s">&quot;example-config.json&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">String</span><span class="p">.</span><span class="na">join</span><span class="p">(</span><span class="s">&quot;\n&quot;</span><span class="p">,</span><span class="n">Files</span><span class="p">.</span><span class="na">readAllLines</span><span class="p">(</span><span class="n">configPath</span><span class="p">));</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{
  &#34;config&#34; : {
    &#34;components&#34; : [ {
      &#34;name&#34; : &#34;mnist-test&#34;,
      &#34;type&#34; : &#34;org.tribuo.datasource.IDXDataSource&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;featuresPath&#34; : &#34;t10k-images-idx3-ubyte.gz&#34;,
        &#34;outputPath&#34; : &#34;t10k-labels-idx1-ubyte.gz&#34;,
        &#34;outputFactory&#34; : &#34;label-factory&#34;
      }
    }, {
      &#34;name&#34; : &#34;mnist-train&#34;,
      &#34;type&#34; : &#34;org.tribuo.datasource.IDXDataSource&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;featuresPath&#34; : &#34;train-images-idx3-ubyte.gz&#34;,
        &#34;outputPath&#34; : &#34;train-labels-idx1-ubyte.gz&#34;,
        &#34;outputFactory&#34; : &#34;label-factory&#34;
      }
    }, {
      &#34;name&#34; : &#34;adagrad&#34;,
      &#34;type&#34; : &#34;org.tribuo.math.optimisers.AdaGrad&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;epsilon&#34; : &#34;0.01&#34;,
        &#34;initialLearningRate&#34; : &#34;0.5&#34;
      }
    }, {
      &#34;name&#34; : &#34;log&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.sgd.objectives.LogMulticlass&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;
    }, {
      &#34;name&#34; : &#34;label-factory&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.LabelFactory&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;
    }, {
      &#34;name&#34; : &#34;gini&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.dtree.impurity.GiniIndex&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;
    }, {
      &#34;name&#34; : &#34;cart&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.dtree.CARTClassificationTrainer&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;maxDepth&#34; : &#34;6&#34;,
        &#34;impurity&#34; : &#34;gini&#34;,
        &#34;seed&#34; : &#34;12345&#34;,
        &#34;fractionFeaturesInSplit&#34; : &#34;0.5&#34;
      }
    }, {
      &#34;name&#34; : &#34;entropy&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.dtree.impurity.Entropy&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;
    }, {
      &#34;name&#34; : &#34;logistic&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.sgd.linear.LinearSGDTrainer&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;seed&#34; : &#34;1&#34;,
        &#34;minibatchSize&#34; : &#34;1&#34;,
        &#34;epochs&#34; : &#34;2&#34;,
        &#34;optimiser&#34; : &#34;adagrad&#34;,
        &#34;objective&#34; : &#34;log&#34;,
        &#34;loggingInterval&#34; : &#34;10000&#34;
      }
    }, {
      &#34;name&#34; : &#34;xgboost&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.xgboost.XGBoostClassificationTrainer&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;numTrees&#34; : &#34;10&#34;,
        &#34;maxDepth&#34; : &#34;4&#34;,
        &#34;eta&#34; : &#34;0.5&#34;,
        &#34;seed&#34; : &#34;1&#34;,
        &#34;minChildWeight&#34; : &#34;1.0&#34;,
        &#34;subsample&#34; : &#34;1.0&#34;,
        &#34;nThread&#34; : &#34;6&#34;,
        &#34;gamma&#34; : &#34;0.1&#34;
      }
    } ]
  }
}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we'll make a <code>ConfigurationManager</code> and hand it the configuration file to load. Our configuration system also supports CLI options which can load things out of the supplied configuration files. We have examples of this in each of the simple <code>TrainTest</code> demo classes in each prediction backend.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">cm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConfigurationManager</span><span class="p">(</span><span class="n">configPath</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we'll load in the training and testing <code>DataSource</code>s (as instances of <code>IDXDataSource</code>), pass them into two <code>Dataset</code>s to aggregate the appropriate metadata, and we'll make the evaluator for later use.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="n">DataSource</span><span class="o">&lt;</span><span class="n">Label</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mnistTrain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">DataSource</span><span class="o">&lt;</span><span class="n">Label</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">cm</span><span class="p">.</span><span class="na">lookup</span><span class="p">(</span><span class="s">&quot;mnist-train&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">DataSource</span><span class="o">&lt;</span><span class="n">Label</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mnistTest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">DataSource</span><span class="o">&lt;</span><span class="n">Label</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">cm</span><span class="p">.</span><span class="na">lookup</span><span class="p">(</span><span class="s">&quot;mnist-test&quot;</span><span class="p">);</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">trainData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MutableDataset</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">mnistTrain</span><span class="p">);</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">testData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MutableDataset</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">mnistTest</span><span class="p">);</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">evaluator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LabelEvaluator</span><span class="p">();</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;Training data size = %d, number of features = %d, number of classes = %d&quot;</span><span class="p">,</span><span class="n">trainData</span><span class="p">.</span><span class="na">size</span><span class="p">(),</span><span class="n">trainData</span><span class="p">.</span><span class="na">getFeatureMap</span><span class="p">().</span><span class="na">size</span><span class="p">(),</span><span class="n">trainData</span><span class="p">.</span><span class="na">getOutputInfo</span><span class="p">().</span><span class="na">size</span><span class="p">()));</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;Testing data size = %d, number of features = %d, number of classes = %d&quot;</span><span class="p">,</span><span class="n">testData</span><span class="p">.</span><span class="na">size</span><span class="p">(),</span><span class="n">testData</span><span class="p">.</span><span class="na">getFeatureMap</span><span class="p">().</span><span class="na">size</span><span class="p">(),</span><span class="n">testData</span><span class="p">.</span><span class="na">getOutputInfo</span><span class="p">().</span><span class="na">size</span><span class="p">()));</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Training data size = 60000, number of features = 717, number of classes = 10
Testing data size = 10000, number of features = 668, number of classes = 10
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loading-in-trainers-from-the-configuration">Loading in trainers from the configuration<a class="anchor-link" href="#Loading-in-trainers-from-the-configuration">&#182;</a></h2><p>Our configuration file contains a number of different trainers, so let's pull them out and take a look.</p>
<p>The first one we'll see is a CART decision tree, with a max tree depth of 6.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">cart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Trainer</span><span class="o">&lt;</span><span class="n">Label</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">cm</span><span class="p">.</span><span class="na">lookup</span><span class="p">(</span><span class="s">&quot;cart&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">cart</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>CARTClassificationTrainer(maxDepth=6,minChildWeight=5.0,minImpurityDecrease=0.0,fractionFeaturesInSplit=0.5,useRandomSplitPoints=false,impurity=GiniIndex,seed=12345)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next we'll load an XGBoost trainer, using 10 trees, 6 computation threads, and some regularisation parameters. Note: Tribuo's XGBoost support relies upon the Maven Central XGBoost jar from DMLC which contains macOS and Linux binaries, on Windows please compile DMLC's XGBoost jar from source and rebuild Tribuo.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">xgb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Trainer</span><span class="o">&lt;</span><span class="n">Label</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">cm</span><span class="p">.</span><span class="na">lookup</span><span class="p">(</span><span class="s">&quot;xgboost&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">xgb</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>XGBoostTrainer(numTrees=10,parameters{colsample_bytree=1.0, tree_method=auto, seed=1, max_depth=4, booster=gbtree, objective=multi:softprob, lambda=1.0, eta=0.5, nthread=6, alpha=1.0, subsample=1.0, gamma=0.1, min_child_weight=1.0, verbosity=0})</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally we'll load in a logistic regression trainer, using AdaGrad as the gradient optimizer.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">logistic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Trainer</span><span class="o">&lt;</span><span class="n">Label</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">cm</span><span class="p">.</span><span class="na">lookup</span><span class="p">(</span><span class="s">&quot;logistic&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">logistic</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>LinearSGDTrainer(objective=LogMulticlass,optimiser=AdaGrad(initialLearningRate=0.5,epsilon=0.01,initialValue=0.0),epochs=2,minibatchSize=1,seed=1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also load a list in containing all the <code>Trainer</code> implementations in this config file. Note: the config system by default returns the same instance when it's queried for the same named config. So the list contains references to the objects we've already loaded.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">trainers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Trainer</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">cm</span><span class="p">.</span><span class="na">lookupAll</span><span class="p">(</span><span class="n">Trainer</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Loaded &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">trainers</span><span class="p">.</span><span class="na">size</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; trainers.&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Loaded 3 trainers.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training-the-model-and-extracting-configuration">Training the model and extracting configuration<a class="anchor-link" href="#Training-the-model-and-extracting-configuration">&#182;</a></h2><p>We're going to focus on the logistic regression trainer now, so let's train a logistic regression model on our MNIST training set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">lrStartTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">lrModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logistic</span><span class="p">.</span><span class="na">train</span><span class="p">(</span><span class="n">trainData</span><span class="p">);</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">lrEndTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Training logistic regression took &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Util</span><span class="p">.</span><span class="na">formatDuration</span><span class="p">(</span><span class="n">lrStartTime</span><span class="p">,</span><span class="n">lrEndTime</span><span class="p">));</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Training logistic regression took (00:00:04:874)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can inspect the trained model for it's provenance, as we saw in the Classification tutorial.</p>
<p>The new step is extracting a configuration from that provenance. The <code>ProvenanceUtil.extractConfiguration()</code> call returns a <code>List&lt;ConfigurationData&gt;</code> which is the object representation of a configuration file. We can see that it's extracted configurations for 5 objects from our single model, we'll look at those after we've written out the file.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">provenance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lrModel</span><span class="p">.</span><span class="na">getProvenance</span><span class="p">();</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">provConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProvenanceUtil</span><span class="p">.</span><span class="na">extractConfiguration</span><span class="p">(</span><span class="n">provenance</span><span class="p">);</span><span class="w"></span>
<span class="n">provConfig</span><span class="p">.</span><span class="na">size</span><span class="p">()</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>5</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>ConfigurationManager</code> is the way we can generate a configuration file from the object representation.
We create a new <code>ConfigurationManager</code>, add the configuration we extracted from the provenance, and then write
it out to a new JSON file.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">outputFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;mnist-logistic-config.json&quot;</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">newCM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConfigurationManager</span><span class="p">();</span><span class="w"></span>
<span class="n">newCM</span><span class="p">.</span><span class="na">addConfiguration</span><span class="p">(</span><span class="n">provConfig</span><span class="p">);</span><span class="w"></span>
<span class="n">newCM</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">outputFile</span><span class="p">),</span><span class="kc">true</span><span class="p">);</span><span class="w"></span>
<span class="n">String</span><span class="p">.</span><span class="na">join</span><span class="p">(</span><span class="s">&quot;\n&quot;</span><span class="p">,</span><span class="n">Files</span><span class="p">.</span><span class="na">readAllLines</span><span class="p">(</span><span class="n">Paths</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">outputFile</span><span class="p">)))</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[16]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{
  &#34;config&#34; : {
    &#34;components&#34; : [ {
      &#34;name&#34; : &#34;idxdatasource-1&#34;,
      &#34;type&#34; : &#34;org.tribuo.datasource.IDXDataSource&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;outputPath&#34; : &#34;/local/ExternalRepositories/tribuo/tutorials/train-labels-idx1-ubyte.gz&#34;,
        &#34;outputFactory&#34; : &#34;labelfactory-4&#34;,
        &#34;featuresPath&#34; : &#34;/local/ExternalRepositories/tribuo/tutorials/train-images-idx3-ubyte.gz&#34;
      }
    }, {
      &#34;name&#34; : &#34;linearsgdtrainer-0&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.sgd.linear.LinearSGDTrainer&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;seed&#34; : &#34;1&#34;,
        &#34;minibatchSize&#34; : &#34;1&#34;,
        &#34;shuffle&#34; : &#34;true&#34;,
        &#34;epochs&#34; : &#34;2&#34;,
        &#34;optimiser&#34; : &#34;adagrad-2&#34;,
        &#34;loggingInterval&#34; : &#34;10000&#34;,
        &#34;objective&#34; : &#34;logmulticlass-3&#34;
      }
    }, {
      &#34;name&#34; : &#34;adagrad-2&#34;,
      &#34;type&#34; : &#34;org.tribuo.math.optimisers.AdaGrad&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;epsilon&#34; : &#34;0.01&#34;,
        &#34;initialLearningRate&#34; : &#34;0.5&#34;,
        &#34;initialValue&#34; : &#34;0.0&#34;
      }
    }, {
      &#34;name&#34; : &#34;labelfactory-4&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.LabelFactory&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;
    }, {
      &#34;name&#34; : &#34;logmulticlass-3&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.sgd.objectives.LogMulticlass&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;
    } ]
  }
}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The five elements of the configuration are: the training data "idxdatasource-1", the logistic regression "linearsgdtrainer-0", the training log loss function "logmulticlass-3", the AdaGrad gradient optimizer "adagrad-2", and the label factory "labelfactory-4". The only unexpected part is the <code>LabelFactory</code> which is the factory that converts <code>String</code>s into <code>Label</code> instances.</p>
<h2 id="Rebuilding-a-model-from-it's-configuration">Rebuilding a model from it's configuration<a class="anchor-link" href="#Rebuilding-a-model-from-it's-configuration">&#182;</a></h2><p>Now to reconstruct our model, we can load in the Trainer and DataSource from the new <code>ConfigurationManager</code>, pass the source into a <code>Dataset</code>, and finally call train on the new trainer supplying the new dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">newTrainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Trainer</span><span class="o">&lt;</span><span class="n">Label</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">newCM</span><span class="p">.</span><span class="na">lookup</span><span class="p">(</span><span class="s">&quot;linearsgdtrainer-0&quot;</span><span class="p">);</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">newSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">DataSource</span><span class="o">&lt;</span><span class="n">Label</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">newCM</span><span class="p">.</span><span class="na">lookup</span><span class="p">(</span><span class="s">&quot;idxdatasource-1&quot;</span><span class="p">);</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">newDataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MutableDataset</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">newSource</span><span class="p">);</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">newModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newTrainer</span><span class="p">.</span><span class="na">train</span><span class="p">(</span><span class="n">newDataset</span><span class="p">,</span><span class="w"> </span><span class="n">Map</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;reconfigured-model&quot;</span><span class="p">,</span><span class="k">new</span><span class="w"> </span><span class="n">BooleanProvenance</span><span class="p">(</span><span class="s">&quot;reconfigured-model&quot;</span><span class="p">,</span><span class="kc">true</span><span class="p">)));</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we'll confirm that the old model and new models aren't equal (as they have different timestamps, among other provenance checks).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="n">lrModel</span><span class="p">.</span><span class="na">getProvenance</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">newModel</span><span class="p">.</span><span class="na">getProvenance</span><span class="p">())</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[18]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>false</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we'll evaluate the first model:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">lrEvaluator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">evaluator</span><span class="p">.</span><span class="na">evaluate</span><span class="p">(</span><span class="n">lrModel</span><span class="p">,</span><span class="n">testData</span><span class="p">);</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">lrEvaluator</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">lrEvaluator</span><span class="p">.</span><span class="na">getConfusionMatrix</span><span class="p">().</span><span class="na">toString</span><span class="p">());</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Class                           n          tp          fn          fp      recall        prec          f1
0                             980         904          76          21       0.922       0.977       0.949
1                           1,135       1,072          63          18       0.944       0.983       0.964
2                           1,032         856         176          56       0.829       0.939       0.881
3                           1,010         844         166          84       0.836       0.909       0.871
4                             982         888          94          72       0.904       0.925       0.915
5                             892         751         141         143       0.842       0.840       0.841
6                             958         938          20         139       0.979       0.871       0.922
7                           1,028         963          65         133       0.937       0.879       0.907
8                             974         892          82         363       0.916       0.711       0.800
9                           1,009         801         208          62       0.794       0.928       0.856
Total                      10,000       8,909       1,091       1,091
Accuracy                                                                    0.891
Micro Average                                                               0.891       0.891       0.891
Macro Average                                                               0.890       0.896       0.890
Balanced Error Rate                                                         0.110
               0       1       2       3       4       5       6       7       8       9
0            904       0       2       3       1      20      26       4      18       2
1              0   1,072       7       3       0       2       6       2      43       0
2              3       6     856      26       5       7      39       8      80       2
3              1       0      13     844       2      64       7      14      62       3
4              0       0       7       2     888       1      22      15      20      27
5              9       1       1      27       6     751      18       7      68       4
6              3       1       2       1       1       9     938       1       2       0
7              1       5      18       6       4       1       0     963       9      21
8              1       3       6       9       9      25      20       6     892       3
9              3       2       0       7      44      14       1      76      61     801

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's about what we'd expect for a linear model on MNIST. Not state-of-the-art (SOTA), but it'll do for now.</p>
<p>Now let's check the new model:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">newEvaluator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">evaluator</span><span class="p">.</span><span class="na">evaluate</span><span class="p">(</span><span class="n">newModel</span><span class="p">,</span><span class="n">testData</span><span class="p">);</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">newEvaluator</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">newEvaluator</span><span class="p">.</span><span class="na">getConfusionMatrix</span><span class="p">().</span><span class="na">toString</span><span class="p">());</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Class                           n          tp          fn          fp      recall        prec          f1
0                             980         904          76          21       0.922       0.977       0.949
1                           1,135       1,072          63          18       0.944       0.983       0.964
2                           1,032         856         176          56       0.829       0.939       0.881
3                           1,010         844         166          84       0.836       0.909       0.871
4                             982         888          94          72       0.904       0.925       0.915
5                             892         751         141         143       0.842       0.840       0.841
6                             958         938          20         139       0.979       0.871       0.922
7                           1,028         963          65         133       0.937       0.879       0.907
8                             974         892          82         363       0.916       0.711       0.800
9                           1,009         801         208          62       0.794       0.928       0.856
Total                      10,000       8,909       1,091       1,091
Accuracy                                                                    0.891
Micro Average                                                               0.891       0.891       0.891
Macro Average                                                               0.890       0.896       0.890
Balanced Error Rate                                                         0.110
               0       1       2       3       4       5       6       7       8       9
0            904       0       2       3       1      20      26       4      18       2
1              0   1,072       7       3       0       2       6       2      43       0
2              3       6     856      26       5       7      39       8      80       2
3              1       0      13     844       2      64       7      14      62       3
4              0       0       7       2     888       1      22      15      20      27
5              9       1       1      27       6     751      18       7      68       4
6              3       1       2       1       1       9     938       1       2       0
7              1       5      18       6       4       1       0     963       9      21
8              1       3       6       9       9      25      20       6     892       3
9              3       2       0       7      44      14       1      76      61     801

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that both models perform identically. This is because our provenance system records the RNG seeds used at all points, and Tribuo is scrupulous about how and when it uses PRNGs. If you find a model reconstruction that gives a different answer (unless you're using XGBoost or TensorFlow, both of which have some non-determinism beyond our control) then file an issue on our GitHub as that's a bug.</p>
<p>We provide a simple push-button replication facility in the <code>tribuo-reproducibility</code> project, see the tutorial on reproducibilty for more details.</p>
<h2 id="What-else-lives-in-the-Provenance?">What else lives in the Provenance?<a class="anchor-link" href="#What-else-lives-in-the-Provenance?">&#182;</a></h2><p>These evaluations have provenance in the same way the models do, and we can use a pretty printer in OLCUT to make it a little more human readable.</p>
<p>In addition to the configuration information like the gradient optimiser and RNG seed, the provenance includes run specific information like the "reconfigured-model" flag we added, along with a hash of the data, timestamps for the various data files involved, and a timestamp for the model creation and dataset creation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">evalProvenance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newEvaluator</span><span class="p">.</span><span class="na">getProvenance</span><span class="p">();</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">ProvenanceUtil</span><span class="p">.</span><span class="na">formattedProvenanceString</span><span class="p">(</span><span class="n">evalProvenance</span><span class="p">));</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>EvaluationProvenance(
	class-name = org.tribuo.provenance.EvaluationProvenance
	model-provenance = LinearSGDModel(
			class-name = org.tribuo.classification.sgd.linear.LinearSGDModel
			dataset = MutableDataset(
					class-name = org.tribuo.MutableDataset
					datasource = IDXDataSource(
							class-name = org.tribuo.datasource.IDXDataSource
							outputPath = /local/ExternalRepositories/tribuo/tutorials/train-labels-idx1-ubyte.gz
							outputFactory = LabelFactory(
									class-name = org.tribuo.classification.LabelFactory
								)
							featuresPath = /local/ExternalRepositories/tribuo/tutorials/train-images-idx3-ubyte.gz
							features-file-modified-time = 2000-07-21T14:20:24-04:00
							output-resource-hash = 3552534A0A558BBED6AED32B30C495CCA23D567EC52CAC8BE1A0730E8010255C
							datasource-creation-time = 2022-10-07T11:33:57.506314-04:00
							output-file-modified-time = 2000-07-21T14:20:27-04:00
							idx-feature-type = UBYTE
							features-resource-hash = 440FCABF73CC546FA21475E81EA370265605F56BE210A4024D2CA8F203523609
							host-short-name = DataSource
						)
					transformations = List[]
					is-sequence = false
					is-dense = false
					num-examples = 60000
					num-features = 717
					num-outputs = 10
					tribuo-version = 4.3.0
				)
			trainer = LinearSGDTrainer(
					class-name = org.tribuo.classification.sgd.linear.LinearSGDTrainer
					seed = 1
					minibatchSize = 1
					shuffle = true
					epochs = 2
					optimiser = AdaGrad(
							class-name = org.tribuo.math.optimisers.AdaGrad
							epsilon = 0.01
							initialLearningRate = 0.5
							initialValue = 0.0
							host-short-name = StochasticGradientOptimiser
						)
					loggingInterval = 10000
					objective = LogMulticlass(
							class-name = org.tribuo.classification.sgd.objectives.LogMulticlass
							host-short-name = LabelObjective
						)
					tribuo-version = 4.3.0
					train-invocation-count = 0
					is-sequence = false
					host-short-name = Trainer
				)
			trained-at = 2022-10-07T11:34:03.181752-04:00
			instance-values = Map{
				reconfigured-model=true
			}
			tribuo-version = 4.3.0
			java-version = 12
			os-name = Linux
			os-arch = amd64
		)
	dataset-provenance = MutableDataset(
			class-name = org.tribuo.MutableDataset
			datasource = IDXDataSource(
					class-name = org.tribuo.datasource.IDXDataSource
					outputPath = /local/ExternalRepositories/tribuo/tutorials/t10k-labels-idx1-ubyte.gz
					outputFactory = LabelFactory(
							class-name = org.tribuo.classification.LabelFactory
						)
					featuresPath = /local/ExternalRepositories/tribuo/tutorials/t10k-images-idx3-ubyte.gz
					features-file-modified-time = 2000-07-21T14:19:56-04:00
					output-resource-hash = F7AE60F92E00EC6DEBD23A6088C31DBD2371ECA3FFA0DEFAEFB259924204AEC6
					datasource-creation-time = 2022-10-07T11:33:44.880399-04:00
					output-file-modified-time = 2000-07-21T14:20:05-04:00
					idx-feature-type = UBYTE
					features-resource-hash = 8D422C7B0A1C1C79245A5BCF07FE86E33EEAFEE792B84584AEC276F5A2DBC4E6
					host-short-name = DataSource
				)
			transformations = List[]
			is-sequence = false
			is-dense = false
			num-examples = 10000
			num-features = 668
			num-outputs = 10
			tribuo-version = 4.3.0
		)
	tribuo-version = 4.3.0
)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Feature-Transformations">Feature Transformations<a class="anchor-link" href="#Feature-Transformations">&#182;</a></h2><p>We can take the new trainer, wrap it programmatically in a TransfomTrainer which rescales the input features into the range <code>[0,1]</code>, and still generate provenance and configuration automatically as the model is trained.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">transformations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TransformationMap</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">LinearScalingTransformation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)));</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">transformed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TransformTrainer</span><span class="p">(</span><span class="n">newTrainer</span><span class="p">,</span><span class="n">transformations</span><span class="p">);</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">transformStart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">transformedModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformed</span><span class="p">.</span><span class="na">train</span><span class="p">(</span><span class="n">newDataset</span><span class="p">);</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">transformEnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Training transformed logistic regression took &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Util</span><span class="p">.</span><span class="na">formatDuration</span><span class="p">(</span><span class="n">transformStart</span><span class="p">,</span><span class="n">transformEnd</span><span class="p">));</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Training transformed logistic regression took (00:00:06:555)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we'll evaluate the rescaled model. Here we see that rescaling the data into the zero-one range improves the linear model performance a couple of percent as all the data is now on the same scale. As expected it's still not SOTA, but we're not using a huge CNN or some other complex model, for that you can try out our <a href="https://github.com/oracle/tribuo/blob/main/tutorials/tensorflow-tribuo-v4.ipynb">TensorFlow interface</a>, or use the XGBoost trainer we loaded in from the original configuration file.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="n">LabelEvaluation</span><span class="w"> </span><span class="n">transformedEvaluator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">evaluator</span><span class="p">.</span><span class="na">evaluate</span><span class="p">(</span><span class="n">transformedModel</span><span class="p">,</span><span class="n">testData</span><span class="p">);</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">transformedEvaluator</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">transformedEvaluator</span><span class="p">.</span><span class="na">getConfusionMatrix</span><span class="p">().</span><span class="na">toString</span><span class="p">());</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Class                           n          tp          fn          fp      recall        prec          f1
0                             980         957          23          40       0.977       0.960       0.968
1                           1,135       1,109          26          36       0.977       0.969       0.973
2                           1,032         940          92          90       0.911       0.913       0.912
3                           1,010         927          83         141       0.918       0.868       0.892
4                             982         914          68          73       0.931       0.926       0.928
5                             892         813          79         183       0.911       0.816       0.861
6                             958         892          66          45       0.931       0.952       0.941
7                           1,028         918         110          54       0.893       0.944       0.918
8                             974         753         221          60       0.773       0.926       0.843
9                           1,009         926          83         129       0.918       0.878       0.897
Total                      10,000       9,149         851         851
Accuracy                                                                    0.915
Micro Average                                                               0.915       0.915       0.915
Macro Average                                                               0.914       0.915       0.913
Balanced Error Rate                                                         0.086
               0       1       2       3       4       5       6       7       8       9
0            957       0       1       2       1      12       4       2       1       0
1              0   1,109      10       3       0       2       3       2       6       0
2              4       9     940      18       9       7      11      11      19       4
3              6       0      25     927       0      26       2       7       9       8
4              1       1       7       4     914       0       9       7       4      35
5              7       1       2      30       8     813       9       3      18       1
6              8       2      14       3       8      27     892       2       2       0
7              1       7      17      19       8       1       0     918       1      56
8              7       9      13      46      11      93       7      10     753      25
9              6       7       1      16      28      15       0      10       0     926

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can emit a configuration which includes both the transformation trainer and the original trainer pulled from the old configuration. We'll write it out to a byte array rather than putting it on disk, but the process is the same.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">transformedProvConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProvenanceUtil</span><span class="p">.</span><span class="na">extractConfiguration</span><span class="p">(</span><span class="n">transformedModel</span><span class="p">.</span><span class="na">getProvenance</span><span class="p">());</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">baos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ByteArrayOutputStream</span><span class="p">();</span><span class="w"></span>
<span class="n">newCM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConfigurationManager</span><span class="p">();</span><span class="w"></span>
<span class="n">newCM</span><span class="p">.</span><span class="na">addConfiguration</span><span class="p">(</span><span class="n">transformedProvConfig</span><span class="p">);</span><span class="w"></span>
<span class="n">newCM</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">baos</span><span class="p">,</span><span class="s">&quot;json&quot;</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span><span class="w"></span>
<span class="n">baos</span><span class="p">.</span><span class="na">toString</span><span class="p">();</span><span class="w"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[24]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{
  &#34;config&#34; : {
    &#34;components&#34; : [ {
      &#34;name&#34; : &#34;linearscalingtransformation-4&#34;,
      &#34;type&#34; : &#34;org.tribuo.transform.transformations.LinearScalingTransformation&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;targetMax&#34; : &#34;1.0&#34;,
        &#34;targetMin&#34; : &#34;0.0&#34;
      }
    }, {
      &#34;name&#34; : &#34;labelfactory-7&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.LabelFactory&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;
    }, {
      &#34;name&#34; : &#34;adagrad-5&#34;,
      &#34;type&#34; : &#34;org.tribuo.math.optimisers.AdaGrad&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;epsilon&#34; : &#34;0.01&#34;,
        &#34;initialLearningRate&#34; : &#34;0.5&#34;,
        &#34;initialValue&#34; : &#34;0.0&#34;
      }
    }, {
      &#34;name&#34; : &#34;linearsgdtrainer-2&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.sgd.linear.LinearSGDTrainer&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;seed&#34; : &#34;1&#34;,
        &#34;minibatchSize&#34; : &#34;1&#34;,
        &#34;shuffle&#34; : &#34;true&#34;,
        &#34;epochs&#34; : &#34;2&#34;,
        &#34;optimiser&#34; : &#34;adagrad-5&#34;,
        &#34;loggingInterval&#34; : &#34;10000&#34;,
        &#34;objective&#34; : &#34;logmulticlass-6&#34;
      }
    }, {
      &#34;name&#34; : &#34;transformtrainer-0&#34;,
      &#34;type&#34; : &#34;org.tribuo.transform.TransformTrainer&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;includeImplicitZeroFeatures&#34; : &#34;false&#34;,
        &#34;transformations&#34; : &#34;transformationmap-1&#34;,
        &#34;densify&#34; : &#34;false&#34;,
        &#34;innerTrainer&#34; : &#34;linearsgdtrainer-2&#34;
      }
    }, {
      &#34;name&#34; : &#34;logmulticlass-6&#34;,
      &#34;type&#34; : &#34;org.tribuo.classification.sgd.objectives.LogMulticlass&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;
    }, {
      &#34;name&#34; : &#34;idxdatasource-3&#34;,
      &#34;type&#34; : &#34;org.tribuo.datasource.IDXDataSource&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;outputPath&#34; : &#34;/local/ExternalRepositories/tribuo/tutorials/train-labels-idx1-ubyte.gz&#34;,
        &#34;outputFactory&#34; : &#34;labelfactory-7&#34;,
        &#34;featuresPath&#34; : &#34;/local/ExternalRepositories/tribuo/tutorials/train-images-idx3-ubyte.gz&#34;
      }
    }, {
      &#34;name&#34; : &#34;transformationmap-1&#34;,
      &#34;type&#34; : &#34;org.tribuo.transform.TransformationMap&#34;,
      &#34;export&#34; : &#34;false&#34;,
      &#34;import&#34; : &#34;false&#34;,
      &#34;properties&#34; : {
        &#34;featureTransformationList&#34; : { },
        &#34;globalTransformations&#34; : [ {
          &#34;item&#34; : &#34;linearscalingtransformation-4&#34;
        } ]
      }
    } ]
  }
}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Aside from the names (which have different tag numbers) we can see that this configuration is identical to the previous one, but with the addition of the <code>transformtrainer-0</code> and it's dependents.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">&#182;</a></h2><p>We've taken a closer look at Tribuo's configuration and provenance systems, showing how to train a model using a configuration file, how to inspect the model's provenance, extract it's configuration, and finally how to combine that extracted configuration with other programmatic elements of the Tribuo library (in this case the feature transformation system). We saw that the provenance combines both the configuration of the trainer and the datasource, along with runtime information extracted from the dataset itself (e.g., timestamps and file hashes). Tribuo's provenance objects are also persisted in ONNX model files exported from Tribuo, and these provenances can be recovered later using Tribuo's <code>ONNXExternalModel</code> class which provides ONNX model inference. For more details on ONNX export see the ONNX export and deployment tutorial.</p>
<p>Tribuo's configuration system is integrated into a CLI options/arguments parsing system, which can be used to override elements from the configuration file. The values from the options are then stored in the <code>ConfigurationManager</code> and appear in the provenance and downstream configuration objects as expected. Tribuo also provides a redaction system for configuration files (e.g., to ensure a password isn't stored in the provenance) and for provenance objects themselves (e.g., to remove the data provenance from a trained model), which aids model deployment to untrusted or less trusted systems.</p>

</div>
</div>
</div>
    </div>
  </div>
</body>

